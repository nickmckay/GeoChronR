<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate a Bayesian Reconstruction Age Model  (Bacon) and add it into a LiPD object — runBchron • geoChronR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Generate a Bayesian Reconstruction Age Model  (Bacon) and add it into a LiPD object — runBchron" />
<meta property="og:description" content="This is a high-level function that uses Bchron to simulate an age model, and stores this as an age-ensemble in a model in chronData. If needed input variables are not entered, and cannot be deduced, it will run in interactive mode. See Haslett and Parnell (2008) doi:10.1111/j.1467-9876.2008.00623.x for details." />
<meta property="og:image" content="https://nickmckay.github.io/geoChronR/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geoChronR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Getting Started With geoChronR</li>
    <li>
      <a href="../articles/Introduction.html">Introduction to geoChronR</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Ensemble Correlation</a>
    </li>
    <li>
      <a href="../articles/regression.html">Ensemble Regression</a>
    </li>
    <li>
      <a href="../articles/spectral_analysis.html">Spectral Analysis</a>
    </li>
    <li>
      <a href="../articles/PCA.html">Ensemble Principal Components Analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Tutorials highlighting additional geoChronR use cases</li>
    <li>
      <a href="../articles/oxCal.html">Introduction to oxCal in geoChronR</a>
    </li>
    <li>
      <a href="../articles/PlotTimeseriesStack.html">Plot a stack of timeseries</a>
    </li>
    <li>
      <a href="../articles/TsFilteringAndMapping.html">Dataset filtering and mapping (with iso2k)</a>
    </li>
    <li>
      <a href="../articles/tidyIso2k.html">Tidy filtering and mapping (with tidyverse &amp; iso2k)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nickmckay/GeoChronR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate a Bayesian Reconstruction Age Model  (Bacon) and add it into a LiPD object</h1>
    <small class="dont-index">Source: <a href='https://github.com/nickmckay/GeoChronR/blob/master/R/run.bchron.LiPD.R'><code>R/run.bchron.LiPD.R</code></a></small>
    <div class="hidden name"><code>runBchron.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a high-level function that uses Bchron to simulate an age model, and stores this as an age-ensemble in a model in chronData. If needed input variables are not entered, and cannot be deduced, it will run in interactive mode. See Haslett and Parnell (2008) doi:10.1111/j.1467-9876.2008.00623.x for details.</p>
    </div>

    <pre class="usage"><span class='fu'>runBchron</span><span class='op'>(</span>
  <span class='va'>L</span>,
  chron.num <span class='op'>=</span> <span class='cn'>NA</span>,
  meas.table.num <span class='op'>=</span> <span class='cn'>NA</span>,
  site.name <span class='op'>=</span> <span class='va'>L</span><span class='op'>$</span><span class='va'>dataSetName</span>,
  model.num <span class='op'>=</span> <span class='cn'>NA</span>,
  cal.curves <span class='op'>=</span> <span class='cn'>NA</span>,
  iter <span class='op'>=</span> <span class='fl'>10000</span>,
  outlier.probs <span class='op'>=</span> <span class='fl'>0.05</span>,
  ask <span class='op'>=</span> <span class='cn'>TRUE</span>,
  lab.id.var <span class='op'>=</span> <span class='st'>"labID"</span>,
  age.14c.var <span class='op'>=</span> <span class='st'>"age14C"</span>,
  age.14c.uncertainty.var <span class='op'>=</span> <span class='st'>"age14CUnc"</span>,
  age.var <span class='op'>=</span> <span class='st'>"age"</span>,
  age.uncertainty.var <span class='op'>=</span> <span class='st'>"ageUnc"</span>,
  depth.var <span class='op'>=</span> <span class='st'>"depth"</span>,
  reservoir.age.14c.var <span class='op'>=</span> <span class='st'>"reservoirAge"</span>,
  reservoir.age.14c.uncertainty.var <span class='op'>=</span> <span class='st'>"reservoirAge14C"</span>,
  rejected.ages.var <span class='op'>=</span> <span class='st'>"rejected"</span>,
  depth.units <span class='op'>=</span> <span class='st'>"cm"</span>,
  which.table <span class='op'>=</span> <span class='cn'>NA</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>L</th>
      <td><p>A LiPD object - an R serialization of a single LiPD file. It's a list, and is typically created by `readLipd()`</p></td>
    </tr>
    <tr>
      <th>chron.num</th>
      <td><p>the number of the chronData object that you'll be working in</p></td>
    </tr>
    <tr>
      <th>meas.table.num</th>
      <td><p>an integer that corresponds to paleo.num measurementTable has the variable you want?</p></td>
    </tr>
    <tr>
      <th>site.name</th>
      <td><p>the name of the site</p></td>
    </tr>
    <tr>
      <th>model.num</th>
      <td><p>chron.numModel do you want to use?</p></td>
    </tr>
    <tr>
      <th>cal.curves</th>
      <td><p>The calibration curves to be used. Enter either "marine13", intcal13", "shcal13" or "normal". Will prompt if not provided.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>number of iterations to use in bchron (default = 10000)</p></td>
    </tr>
    <tr>
      <th>outlier.probs</th>
      <td><p>probability of outliers amongst the dates</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>ask for user input? (True/False)</p></td>
    </tr>
    <tr>
      <th>lab.id.var</th>
      <td><p>Lab Id variable name</p></td>
    </tr>
    <tr>
      <th>age.14c.var</th>
      <td><p>Radiocarbon age variable name</p></td>
    </tr>
    <tr>
      <th>age.14c.uncertainty.var</th>
      <td><p>Radiocarbon age uncertainty variable name</p></td>
    </tr>
    <tr>
      <th>age.var</th>
      <td><p>Calibrated age variable name</p></td>
    </tr>
    <tr>
      <th>age.uncertainty.var</th>
      <td><p>Calibrated age uncertainty variable name</p></td>
    </tr>
    <tr>
      <th>depth.var</th>
      <td><p>Depth variable name</p></td>
    </tr>
    <tr>
      <th>reservoir.age.14c.var</th>
      <td><p>Reservoir age variable name</p></td>
    </tr>
    <tr>
      <th>reservoir.age.14c.uncertainty.var</th>
      <td><p>Reservoir age uncertainty variable name</p></td>
    </tr>
    <tr>
      <th>rejected.ages.var</th>
      <td><p>Rejected ages variable name</p></td>
    </tr>
    <tr>
      <th>depth.units</th>
      <td><p>units for depth</p></td>
    </tr>
    <tr>
      <th>which.table</th>
      <td><p>deprecated. Use meas.table.num instead.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://andrewcparnell.github.io/Bchron/reference/Bchronology.html'>Bchron::Bchronology</a></code></p><dl>
    <dt><code>ages</code></dt><dd><p>A vector of ages provided in years before 1950.</p></dd>
    <dt><code>ageSds</code></dt><dd><p>A vector of 1-sigma values for the ages given above</p></dd>
    <dt><code>positions</code></dt><dd><p>Position values (e.g. depths) for each age. In the case of layers of non-zero thickness, this should be the middle value of the slice</p></dd>
    <dt><code>positionThicknesses</code></dt><dd><p>Thickness values for each of the positions. The thickness value should be the full thickness value of the slice. By default set to zero.</p></dd>
    <dt><code>calCurves</code></dt><dd><p>A vector of values containing either <code>intcal20</code>, <code>shcal20</code>, <code>marine20</code>, or <code>normal</code> (older calibration curves are supposed such as intcal13). Should be the same length the number of ages supplied. Non-standard calibration curves can be used provided they are supplied in the same format as those previously mentioned and are placed in the same directory. Normal indicates a normally-distributed (non-14C) age.</p></dd>
    <dt><code>ids</code></dt><dd><p>ID names for each age</p></dd>
    <dt><code>outlierProbs</code></dt><dd><p>A vector of prior outlier probabilities, one for each age. Defaults to 0.01</p></dd>
    <dt><code>predictPositions</code></dt><dd><p>A vector of positions (e.g. depths) at which predicted age values are required. Defaults to a sequence of length 100 from the top position to the bottom position</p></dd>
    <dt><code>pathToCalCurves</code></dt><dd><p>File path to where the calibration curves are located. Defaults to the system directory where the 3 standard calibration curves are stored.</p></dd>
    <dt><code>artificialThickness</code></dt><dd><p>Amount to add to the thickness values in the case of equal positions with no <code>positionThicknesses</code>. Bchron may fail if <code>positionThicknesses</code> are zero and some positions are repeated. This value is added on to the zero thicknesses (only in the case of repeated positions) to stop this failure.</p></dd>
    <dt><code>allowOutside</code></dt><dd><p>Whether to allow calibrations to run outside the range of the calibration curve. By default this is turned off as calibrations outside of the range of the calibration curve can cause severe issues with probability ranges of calibrated dates</p></dd>
    <dt><code>iterations</code></dt><dd><p>The number of iterations to run the procedure for</p></dd>
    <dt><code>burn</code></dt><dd><p>The number of starting iterations to discard</p></dd>
    <dt><code>thin</code></dt><dd><p>The step size for every iteration to keep beyond the burn-in</p></dd>
    <dt><code>extractDate</code></dt><dd><p>The top age of the core. Used for extrapolation purposes so that no extrapolated ages go beyond the top age of the core. Defaults to the current year</p></dd>
    <dt><code>maxExtrap</code></dt><dd><p>The maximum number of extrapolations to perform before giving up and setting the predicted ages to NA. Useful for when large amounts of extrapolation are required, i.e. some of the <code>predictPositions</code> are a long way from the dated positions</p></dd>
    <dt><code>thetaStart</code></dt><dd><p>A set of starting values for the calendar ages estimated by Bchron. If NULL uses a function to estimate the ages. These should be in the same units as the posterior ages required. See example below for usage.</p></dd>
    <dt><code>thetaMhSd</code></dt><dd><p>The Metropolis-Hastings standard deviation for the age parameters</p></dd>
    <dt><code>muMhSd</code></dt><dd><p>The Metropolis-Hastings standard deviation for the Compound Poisson-Gamma mean</p></dd>
    <dt><code>psiMhSd</code></dt><dd><p>The Metropolis-Hastings standard deviation for the Compound Poisson-Gamma scale</p></dd>
    <dt><code>ageScaleVal</code></dt><dd><p>A scale value for the ages. <code>Bchronology</code> works best when the ages are scaled to be approximately between 0 and 100. The default value is thus 1000 for ages given in years.</p></dd>
    <dt><code>positionEps</code></dt><dd><p>A small value used to check whether simulated positions are far enough apart to avoid numerical underflow errors. If errors occur in model runs (e.g. <code>missing value where TRUE/FALSE needed</code> increase this value)</p></dd>
    <dt><code>positionNormalise</code></dt><dd><p>Whether to normalise the position values. <code>Bchronology</code> works best when the positions are normalised to be between 0 and 1 The default value is <code>TRUE</code></p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>L. The single LiPD object that was entered, with methods, ensembleTable, summaryTable and distributionTable added to the chronData model.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Deborah Khider</p>
<p>Andrew Parnell</p>
<p>Nick McKay</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>#Run in interactive mode:</span>
<span class='va'>L</span> <span class='op'>=</span> <span class='fu'>runBchron</span><span class='op'>(</span><span class='va'>L</span><span class='op'>)</span>

<span class='co'>#Run in noninteractive mode:</span>
<span class='va'>L</span> <span class='op'>=</span> <span class='fu'>runBchron</span><span class='op'>(</span><span class='va'>L</span>,chron.num <span class='op'>=</span> <span class='fl'>1</span>, site.name <span class='op'>=</span> <span class='st'>"MyWonderfulSite"</span>, model.num <span class='op'>=</span> <span class='fl'>3</span>, cal.curves <span class='op'>=</span> <span class='st'>"marine13"</span><span class='op'>)</span> 
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicholas McKay, Julien Emile-Geay, Deborah Khider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '21c1c99b27cf4a45be9f8db70183f6c7',
    indexName: 'lipd-utilities',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


