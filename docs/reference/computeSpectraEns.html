<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate ensemble power spectra — computeSpectraEns • geoChronR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Calculate ensemble power spectra — computeSpectraEns" />
<meta property="og:description" content="Calculate ensemble power spectra using 4 spectral methods:
Lomb-Scargle periodogram
REDFIT (Mudelsee et al, 2009)
Multitaper Method (Thomson et al. 1982)
nuspectral (Mathias et al 2004)  (no confidence estimation)
For REDFIT and MTM, only the 95
For multiple ensemble members, the median of the ensemble of 95
For Lomb-Scargle, the parameter `probs` determines the quantiles of the surrogate spectrum distribution extracted as confidence limits." />
<meta property="og:image" content="https://nickmckay.github.io/geoChronR/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geoChronR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Getting Started With geoChronR</li>
    <li>
      <a href="../articles/Introduction.html">Introduction to geoChronR</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Ensemble Correlation</a>
    </li>
    <li>
      <a href="../articles/regression.html">Ensemble Regression</a>
    </li>
    <li>
      <a href="../articles/spectral_analysis.html">Spectral Analysis</a>
    </li>
    <li>
      <a href="../articles/PCA.html">Ensemble Principal Components Analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Tutorials highlighting additional geoChronR use cases</li>
    <li>
      <a href="../articles/oxCal.html">Introduction to oxCal in geoChronR</a>
    </li>
    <li>
      <a href="../articles/PlotTimeseriesStack.html">Plot a stack of timeseries</a>
    </li>
    <li>
      <a href="../articles/TsFilteringAndMapping.html">Dataset filtering and mapping (with iso2k)</a>
    </li>
    <li>
      <a href="../articles/tidyIso2k.html">Tidy filtering and mapping (with tidyverse &amp; iso2k)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nickmckay/GeoChronR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate ensemble power spectra</h1>
    <small class="dont-index">Source: <a href='https://github.com/nickmckay/GeoChronR/blob/master/R/power.spectra.ens.R'><code>R/power.spectra.ens.R</code></a></small>
    <div class="hidden name"><code>computeSpectraEns.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate ensemble power spectra using 4 spectral methods:</p><ol>
<li><p>Lomb-Scargle periodogram</p></li>
<li><p>REDFIT (Mudelsee et al, 2009)</p></li>
<li><p>Multitaper Method (Thomson et al. 1982)</p></li>
<li><p>nuspectral (Mathias et al 2004)  (no confidence estimation)</p></li>
</ol><p>For REDFIT and MTM, only the 95<!-- % confidence limit is computed. The estimation thereof is as described in Mudelsee et al 2009 for a single ensemble member. -->
For multiple ensemble members, the median of the ensemble of 95<!-- % CLs is taken.   -->
For Lomb-Scargle, the parameter `probs` determines the quantiles of the surrogate spectrum distribution extracted as confidence limits.</p>
    </div>

    <pre class="usage"><span class='fu'>computeSpectraEns</span><span class='op'>(</span>
  <span class='va'>time</span>,
  <span class='va'>values</span>,
  max.ens <span class='op'>=</span> <span class='cn'>NA</span>,
  method <span class='op'>=</span> <span class='st'>"mtm"</span>,
  probs <span class='op'>=</span> <span class='fl'>0.95</span>,
  gaussianize <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ofac <span class='op'>=</span> <span class='fl'>4</span>,
  padfac <span class='op'>=</span> <span class='fl'>2</span>,
  tbw <span class='op'>=</span> <span class='fl'>3</span>,
  wgtrad <span class='op'>=</span> <span class='fl'>1</span>,
  sigma <span class='op'>=</span> <span class='fl'>0.02</span>,
  mtm_null <span class='op'>=</span> <span class='st'>"power_law"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time</th>
      <td><p>LiPD "variable list" or vector of year/age values</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>LiPD "variable list" or vector of values</p></td>
    </tr>
    <tr>
      <th>max.ens</th>
      <td><p>Maximum number of ensemble members to analyze</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method used to compute the spectra. Choose from:</p><ul>
<li><p>'mtm': The multi-taper method (MTM) of Thomson (1982), a mainstay of spectral analysis (Ghil et al. 2002) designed for evenly spaced timeseries. From the astrochron package.</p></li>
<li><p>'redfit': a version of the Lomb-Scargle periodogram tailored to paleoclimatic data (Mudelsee et al. 2009). From the dplR package.</p></li>
<li><p>'lomb-scargle': the Lomb-Scargle periodogram (VanderPlas et al. 2018), which uses an inverse approach to harmonic analysis in unevenly-spaced timeseries. From the lomb package.</p></li>
<li><p>'nuspectral':The wavelet-based method of Mattias et al. (2004). This method is quite similar to the Weighted Wavelet Z-transform algorithm of Foster (1996), though it is prohibitively slow in this implementation. From the nuspectral package.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>vector of probabilities for the siginificance levels. To avoid such computations, pass `probs = NA`.</p></td>
    </tr>
    <tr>
      <th>gaussianize</th>
      <td><p>Boolean flag indicating whether the values should be mapped to a standard Gaussian prior to analysis.</p></td>
    </tr>
    <tr>
      <th>ofac</th>
      <td><p>oversampling factor for lomb::lsp and dplR::redfit</p></td>
    </tr>
    <tr>
      <th>padfac</th>
      <td><p>padding factor for astrochron::mtm___ functions</p></td>
    </tr>
    <tr>
      <th>tbw</th>
      <td><p>time-bandwidth product for astrochron::mtm___ functions</p></td>
    </tr>
    <tr>
      <th>wgtrad</th>
      <td><p>radius of the nuspectral::nuwaveletcoeff weight function (non-dimensional units)</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>decay parameter of the nuspectral::nuwaveletcoeff wavelets</p></td>
    </tr>
    <tr>
      <th>mtm_null</th>
      <td><p>Method to estimate null hypothesis if method = "mtm". Valid choices are 'AR(1)', 'power_law' (default), or 'ML96'</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of ensemble spectra results</p><ul>
<li><p>freqs: vector of frequencies</p></li>
<li><p>power: vector of spectral powers</p></li>
<li><p>power.CL: matrix of confidence limits for spectral power</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Calculate ensemble power spectra</p>
    <h2 class="hasAnchor" id="long-form-example"><a class="anchor" href="#long-form-example"></a>Long-form example</h2>

    

<p><a href='http://nickmckay.github.io/GeoChronR/articles/spectral_analysis.html'>View a full-fledged example of how to use this function.</a></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ghil, M., Allen, R. M., Dettinger, M. D., Ide, K., Kondrashov, D., Mann, M. E., Robertson, A., Saunders, A., Tian, Y., Varadi, F., and Yiou, P.: Advanced spectral methods for climatic time series, Rev. Geophys., 40, 1003–1052, 2002.</p>
<p>Foster, G.: Wavelets for period analysis of unevenly sampled time series, Astron. Jour., 112, 1709, https://doi.org/10.1086/118137, 1996.</p>
<p>Mudelsee, M., D. Scholz, R. Röthlisberger, D. Fleitmann, A. Mangini, and E. W. Wolff (2009), Climate spectrum estimation in the presence of timescale errors, Nonlinear Processes in Geophysics, 16(1), 43–56, doi:10.5194/npg-16-43-2009.</p>
<p>Mathias, A., F. Grond, R. Guardans, D. Seese, M. Canela, and H. Diebner (2004), Algorithms for spectral analysis of irregularly sampled time series, Journal of Statistical Software, Articles, 11(2), 1–27, doi:10.18637/jss.v011.i02.</p>
<p>Thomson, D. J. (1982), Spectrum estimation and harmonic analysis, Proc. IEEE, 70(9), 1055–1096.</p>
<p>VanderPlas, J. T.: Understanding the Lomb–Scargle Periodogram, The Astrophysical Journal Supplement Series, 236, 16, https://doi.org/10.3847/1538-4365/aab766, 2018.</p>
<p>Mann, M. and Lees, J.: Robust Estimation of Background Noise and Signal Detection in Climatic Time Series, Clim. Change, 33, 409–445.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other spectra: 
<code><a href='ar1Surrogates.html'>ar1Surrogates</a>()</code>,
<code><a href='createSyntheticTimeseries.html'>createSyntheticTimeseries</a>()</code>,
<code><a href='periodAnnotate.html'>periodAnnotate</a>()</code>,
<code><a href='plotSpectrum.html'>plotSpectrum</a>()</code>,
<code><a href='reverselog10_trans.html'>reverselog10_trans</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicholas McKay, Julien Emile-Geay, Deborah Khider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '21c1c99b27cf4a45be9f8db70183f6c7',
    indexName: 'lipd-utilities',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


