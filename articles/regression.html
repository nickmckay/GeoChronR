<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ensemble regression and calibration-in-time • geoChronR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Ensemble regression and calibration-in-time">
<meta property="og:description" content="geoChronR">
<meta property="og:image" content="https://nickmckay.github.io/geoChronR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geoChronR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting Started With geoChronR</li>
    <li>
      <a href="../articles/Introduction.html">Introduction to geoChronR</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Ensemble Correlation</a>
    </li>
    <li>
      <a href="../articles/regression.html">Ensemble Regression</a>
    </li>
    <li>
      <a href="../articles/spectral_analysis.html">Spectral Analysis</a>
    </li>
    <li>
      <a href="../articles/PCA.html">Ensemble Principal Components Analysis</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Tutorials highlighting additional geoChronR use cases</li>
    <li>
      <a href="../articles/oxCal.html">Introduction to oxCal in geoChronR</a>
    </li>
    <li>
      <a href="../articles/PlotTimeseriesStack.html">Plot a stack of timeseries</a>
    </li>
    <li>
      <a href="../articles/TsFilteringAndMapping.html">Dataset filtering and mapping (with iso2k)</a>
    </li>
    <li>
      <a href="../articles/tidyIso2k.html">Tidy filtering and mapping (with tidyverse &amp; iso2k)</a>
    </li>
    <li>
      <a href="../articles/AddEnsemble.html">Add a separate ensemble to LiPD object</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nickmckay/GeoChronR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ensemble regression and calibration-in-time</h1>
                        <h4 data-toc-skip class="author">Nick McKay</h4>
            
            <h4 data-toc-skip class="date">2022-08-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nickmckay/GeoChronR/blob/HEAD/vignettes/regression.Rmd" class="external-link"><code>vignettes/regression.Rmd</code></a></small>
      <div class="hidden name"><code>regression.Rmd</code></div>

    </div>

    
    
<ol style="list-style-type: decimal">
<li><a href="Introduction.html">Introduction to geoChronR</a></li>
<li><a href="correlation.html">Age-uncertain correlation</a></li>
<li><a href="regression.html"><strong>Age-uncertain regression and calibration-in-time</strong></a></li>
<li><a href="spectral.html">Age-uncertain spectral analysis</a></li>
<li><a href="pca.html">Age-uncertain PCA analysis</a></li>
</ol>
<div class="section level2">
<h2 id="ensemble-regression-and-calibration-in-time">Ensemble Regression and Calibration-in-time<a class="anchor" aria-label="anchor" href="#ensemble-regression-and-calibration-in-time"></a>
</h2>
<p>Here, we replicate the analysis of Boldt et al. (2015), performing age-uncertain calibration-in-time on a chlorophyll reflectance record from northern Alaska, using geoChronR.</p>
<p>The challenge of age-uncertain calibration-in-time is that age uncertainty affects both the calibration model (the relation between the proxy data and instrumental data) and the reconstruction (the timing of events in the reconstruction). geoChronR simplifies handling these issues.</p>
<p>Let’s start by loading the packages we’ll need.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lipdR</span><span class="op">)</span> <span class="co">#to read and write LiPD files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nickmckay/GeoChronR" class="external-link">geoChronR</a></span><span class="op">)</span> <span class="co">#of course</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span> <span class="co">#to load in the instrumental data we need</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">#for plotting</span></span></code></pre></div>
<div class="section level3">
<h3 id="load-the-lipd-file">Load the LiPD file<a class="anchor" aria-label="anchor" href="#load-the-lipd-file"></a>
</h3>
<p>OK, we’ll begin by loading in the Kurupa Lake record from Boldt et al., 2015. <code>The system.file(...)</code> part of this pulls the example file from the package directory. You’d like just enter the path as a string for typical use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu">lipdR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lipdR/man/readLipd.html" class="external-link">readLipd</a></span><span class="op">(</span><span class="st">"http://lipdverse.org/geoChronR-examples/Kurupa.Boldt.2015.lpd"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "reading: Kurupa.Boldt.2015.lpd"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="check-out-the-contents">Check out the contents<a class="anchor" aria-label="anchor" href="#check-out-the-contents"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSummary.html">plotSummary</a></span><span class="op">(</span><span class="va">K</span>,paleo.data.var <span class="op">=</span> <span class="st">"RABD"</span>,summary.font.size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## TableGrob (4 x 4) "arrange": 4 grobs</span></span>
<span><span class="co">##   z     cells    name                 grob</span></span>
<span><span class="co">## 1 1 (1-1,1-2) arrange gTree[GRID.gTree.11]</span></span>
<span><span class="co">## 2 2 (1-2,3-4) arrange       gtable[layout]</span></span>
<span><span class="co">## 3 3 (2-4,1-2) arrange       gtable[layout]</span></span>
<span><span class="co">## 4 4 (3-4,3-4) arrange       gtable[layout]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="create-an-age-model-with-bacon">Create an age model with Bacon<a class="anchor" aria-label="anchor" href="#create-an-age-model-with-bacon"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runBacon.html">runBacon</a></span><span class="op">(</span><span class="va">K</span>,</span>
<span>              lab.id.var <span class="op">=</span> <span class="st">'labID'</span>, </span>
<span>              age.14c.var <span class="op">=</span> <span class="st">'age14C'</span>, </span>
<span>              age.14c.uncertainty.var <span class="op">=</span> <span class="st">'age14CUncertainty'</span>,</span>
<span>              age.var <span class="op">=</span> <span class="st">'age'</span>, </span>
<span>              age.uncertainty.var <span class="op">=</span> <span class="st">'ageUncertainty'</span>, </span>
<span>              depth.var <span class="op">=</span> <span class="st">'depth'</span>, </span>
<span>              reservoir.age.14c.var <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>              reservoir.age.14c.uncertainty.var <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>              rejected.ages.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              bacon.acc.mean <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              bacon.thick <span class="op">=</span> <span class="fl">7</span>,</span>
<span>              ask <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              bacon.dir <span class="op">=</span> <span class="st">"~/Cores"</span>,</span>
<span>              suggest <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              close.connection <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Using a mix of cal BP and calibrated C-14 dates</span></span></code></pre>
<pre><code><span><span class="co">##  Run Kurupa.Boldt.2015 with 86 sections? (Y/n)</span></span></code></pre>
<pre><code><span><span class="co">##  Will run 17776000 iterations and store around 2019</span></span></code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<pre><code><span><span class="co">## Warning, this will take quite some time to calculate. I suggest increasing d.by to, e.g.10</span></span></code></pre>
<pre><code><span><span class="co">## Calculating age ranges...</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Preparing ghost graph...</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Mean 95% confidence ranges 319 yr, min. 4 yr at 0 cm, max. 525 yr at 315 cm</span></span></code></pre>
<pre><code><span><span class="co">## 100% of the dates overlap with the age-depth model (95% ranges)</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-5-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="and-plot-the-ensemble-output">And plot the ensemble output<a class="anchor" aria-label="anchor" href="#and-plot-the-ensemble-output"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotChron.html">plotChron</a></span><span class="op">(</span><span class="va">K</span>,age.var <span class="op">=</span> <span class="st">"ageEnsemble"</span>,dist.scale <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "plotting your chron ensemble. This make take a few seconds..."</span></span></code></pre>
<pre><code><span><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will</span></span>
<span><span class="co">## replace the existing scale.</span></span></code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="map-the-age-ensemble-to-the-paleodata-table">Map the age ensemble to the paleodata table<a class="anchor" aria-label="anchor" href="#map-the-age-ensemble-to-the-paleodata-table"></a>
</h3>
<p>This is to get ensemble age estimates for each depth in the paleoData measurement table</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mapAgeEnsembleToPaleoData.html">mapAgeEnsembleToPaleoData</a></span><span class="op">(</span><span class="va">K</span>,age.var <span class="op">=</span> <span class="st">"ageEnsemble"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Kurupa.Boldt.2015"</span></span>
<span><span class="co">## [1] "Looking for age ensemble...."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## [1] "getting depth from the paleodata table..."</span></span>
<span><span class="co">## [1] "Found it! Moving on..."</span></span>
<span><span class="co">## mapAgeEnsembleToPaleoData created new variable ageEnsemble in paleo 1 measurement table 1</span></span>
<span><span class="co">## mapAgeEnsembleToPaleoData also created new variable ageMedian in paleo 1 measurement table 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="select-the-paleodata-age-ensemble-and-rabd-data-that-wed-like-to-regress-and-calibrate">Select the paleodata age ensemble, and RABD data that we’d like to regress and calibrate<a class="anchor" aria-label="anchor" href="#select-the-paleodata-age-ensemble-and-rabd-data-that-wed-like-to-regress-and-calibrate"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kae</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">K</span>,<span class="st">"ageEnsemble"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rabd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">K</span>,<span class="st">"RABD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="now-load-in-the-instrumental-data-we-want-to-correlate-and-regress-agains">Now load in the instrumental data we want to correlate and regress agains<a class="anchor" aria-label="anchor" href="#now-load-in-the-instrumental-data-we-want-to-correlate-and-regress-agains"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kurupa.instrumental</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"http://lipdverse.org/geoChronR-examples/KurupaInstrumental.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">134</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (2): Year (AD), JJAS Temperature (deg C)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="check-agetime-units-before-proceeding">Check age/time units before proceeding<a class="anchor" aria-label="anchor" href="#check-agetime-units-before-proceeding"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kae</span><span class="op">$</span><span class="va">units</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "yr BP"</span></span></code></pre>
<p>yep, we need to convert the units from BP to AD</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convertBP2AD.html">convertBP2AD</a></span><span class="op">(</span><span class="va">kae</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-a-variable-list-for-the-instrumental-data">Create a “variable list” for the instrumental data<a class="anchor" aria-label="anchor" href="#create-a-variable-list-for-the-instrumental-data"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kyear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">kyear</span><span class="op">$</span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">kurupa.instrumental</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">kyear</span><span class="op">$</span><span class="va">variableName</span> <span class="op">&lt;-</span> <span class="st">"year"</span></span>
<span><span class="va">kyear</span><span class="op">$</span><span class="va">units</span> <span class="op">&lt;-</span> <span class="st">"AD"</span></span>
<span></span>
<span><span class="va">kinst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">kinst</span><span class="op">$</span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">kurupa.instrumental</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">kinst</span><span class="op">$</span><span class="va">variableName</span> <span class="op">&lt;-</span> <span class="st">"Temperature"</span></span>
<span><span class="va">kinst</span><span class="op">$</span><span class="va">units</span> <span class="op">&lt;-</span> <span class="st">"deg (C)"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-an-ensmeble-correlation-between-the-rabd-and-local-summer-temperature-data">Calculate an ensmeble correlation between the RABD and local summer temperature data<a class="anchor" aria-label="anchor" href="#calculate-an-ensmeble-correlation-between-the-rabd-and-local-summer-temperature-data"></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corEns.html">corEns</a></span><span class="op">(</span><span class="va">kae</span>,<span class="va">rabd</span>,<span class="va">kyear</span>,<span class="va">kinst</span>,bin.step<span class="op">=</span><span class="fl">2</span>,percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>,<span class="fl">.5</span>,<span class="fl">.95</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="and-plot-the-output">And plot the output<a class="anchor" aria-label="anchor" href="#and-plot-the-output"></a>
</h3>
<p>Note that here we use the “Effective-N” significance option as we mimic the Boldt et al. (2015) paper.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotCorEns.html">plotCorEns</a></span><span class="op">(</span><span class="va">corout</span>,significance.option <span class="op">=</span> <span class="st">"eff-n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>Mixed results. But encouraging enough to move forward.</p>
</div>
<div class="section level3">
<h3 id="perform-ensemble-regression">Perform ensemble regression<a class="anchor" aria-label="anchor" href="#perform-ensemble-regression"></a>
</h3>
<p>OK, you’ve convinced yourself that you want to use RABD to model temperature back through time. We can do this simply (perhaps naively) with regession, and lets do it with age uncertainty, both in the building of the model, and the reconstructing</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regressEns.html">regressEns</a></span><span class="op">(</span>time.x <span class="op">=</span> <span class="va">kae</span>,</span>
<span>                    values.x <span class="op">=</span> <span class="va">rabd</span>,</span>
<span>                    time.y <span class="op">=</span><span class="va">kyear</span>,</span>
<span>                    values.y <span class="op">=</span><span class="va">kinst</span>,</span>
<span>                    bin.step<span class="op">=</span><span class="fl">3</span>,</span>
<span>                    gaussianize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    recon.bin.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4010</span>,<span class="fl">2010</span>,by<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="and-plot-the-output-1">And plot the output<a class="anchor" aria-label="anchor" href="#and-plot-the-output-1"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regPlots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotRegressEns.html">plotRegressEns</a></span><span class="op">(</span><span class="va">regout</span>,alp <span class="op">=</span> <span class="fl">0.01</span>,font.size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
<p>This result is consistent with that produced by Boldt et al., (2015), and was much simpler to produce with geoChronR.</p>
<p>In the next vignette learn about <a href="spectral_analysis.html">spectral analysis in geoChronR</a>.</p>
<p>```</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas McKay, Julien Emile-Geay, Deborah Khider.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '21c1c99b27cf4a45be9f8db70183f6c7',
    indexName: 'lipd-utilities',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
