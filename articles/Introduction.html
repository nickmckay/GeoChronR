<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to geoChronR • geoChronR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Introduction to geoChronR">
<meta property="og:description" content="geoChronR">
<meta property="og:image" content="https://nickmckay.github.io/geoChronR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geoChronR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting Started With geoChronR</li>
    <li>
      <a href="../articles/Introduction.html">Introduction to geoChronR</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Ensemble Correlation</a>
    </li>
    <li>
      <a href="../articles/regression.html">Ensemble Regression</a>
    </li>
    <li>
      <a href="../articles/spectral_analysis.html">Spectral Analysis</a>
    </li>
    <li>
      <a href="../articles/PCA.html">Ensemble Principal Components Analysis</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Tutorials highlighting additional geoChronR use cases</li>
    <li>
      <a href="../articles/oxCal.html">Introduction to oxCal in geoChronR</a>
    </li>
    <li>
      <a href="../articles/PlotTimeseriesStack.html">Plot a stack of timeseries</a>
    </li>
    <li>
      <a href="../articles/TsFilteringAndMapping.html">Dataset filtering and mapping (with iso2k)</a>
    </li>
    <li>
      <a href="../articles/tidyIso2k.html">Tidy filtering and mapping (with tidyverse &amp; iso2k)</a>
    </li>
    <li>
      <a href="../articles/AddEnsemble.html">Add a separate ensemble to LiPD object</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nickmckay/GeoChronR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to geoChronR</h1>
                        <h4 data-toc-skip class="author">Nick McKay</h4>
            
            <h4 data-toc-skip class="date">2022-08-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nickmckay/GeoChronR/blob/HEAD/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-geochronr">Welcome to geoChronR!<a class="anchor" aria-label="anchor" href="#welcome-to-geochronr"></a>
</h2>
<p>This is the introductory vignette that showcases the functionality of geoChronR to solve real problems with age uncertain data. Here is a table of contents of the other guides included here:</p>
<ol style="list-style-type: decimal">
<li><a href="Introduction.html"><strong>Introduction to geoChronR</strong></a></li>
<li><a href="correlation.html">Age-uncertain correlation</a></li>
<li><a href="regression.html">Age-uncertain regression and calibration-in-time</a></li>
<li><a href="spectral.html">Age-uncertain spectral analysis</a></li>
<li><a href="pca.html">Age-uncertain PCA analysis</a></li>
</ol>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Almost always, your geoChronR work flow will start with loading in a valid LiPD file. So you’ll want both the geoChronR and lipdR libraries</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nickmckay/GeoChronR" class="external-link">geoChronR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="loading-in-your-data">Loading in your data<a class="anchor" aria-label="anchor" href="#loading-in-your-data"></a>
</h3>
<p>In this case, we’re going to load in the Wang 2001 Hulu Cave dataset that came a long with the package. If you have the lipdR package, you can load a LiPD file directly from your computer, use <code>L &lt;- readLipd()</code> to interactively select a file (or a directory), or enter the path to file or the directory that you want: <code>L &lt;- readLipd("~/Downloads/my.lpd")</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">hulu</span> <span class="op">&lt;-</span> <span class="fu">lipdR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lipdR/man/readLipd.html" class="external-link">readLipd</a></span><span class="op">(</span><span class="st">"http://lipdverse.org/geoChronR-examples/Hulucave.Wang.2001.lpd"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "reading: Hulucave.Wang.2001.lpd"</span></span></code></pre>
<p>Data from five stalagmites are stored in this file. Age model output, including ensemble data, can be stored in LiPD files, but we don’t have that for this record. For this example we’re going to use the original U/Th dates to create a new a model using BChron.</p>
</div>
<div class="section level3">
<h3 id="creating-an-age-model-and-storing-and-visualizing-its-ensembles">Creating an age model, and storing and visualizing its ensembles<a class="anchor" aria-label="anchor" href="#creating-an-age-model-and-storing-and-visualizing-its-ensembles"></a>
</h3>
<p>We’re going to specify many of the parameters here for simplicity, but you can run this with just:</p>
<p><code>hulu &lt;- runBchron(L)</code></p>
<p>and it will prompt you for the details.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runBchron.html">runBchron</a></span><span class="op">(</span><span class="va">hulu</span>,</span>
<span>                  cal.curves <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>                  iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                  extractDate <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                  meas.table.num <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  lab.id.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  age.var <span class="op">=</span> <span class="st">'age'</span>,</span>
<span>                  age.uncertainty.var <span class="op">=</span> <span class="st">'ageUncertaintyHigh'</span>,</span>
<span>                  age.14c.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  age.14c.uncertainty.var <span class="op">=</span>  <span class="cn">NULL</span>,</span>
<span>                  depth.var <span class="op">=</span> <span class="st">'depth'</span>,</span>
<span>                  reservoir.age.14c.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  reservoir.age.14c.uncertainty.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  rejected.ages.var <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#correct units and rename</span></span>
<span><span class="va">hulu</span><span class="op">$</span><span class="va">chronData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ensembleTable</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">depth</span><span class="op">$</span><span class="va">units</span> <span class="op">&lt;-</span> <span class="st">"mm"</span></span>
<span><span class="va">hulu</span><span class="op">$</span><span class="va">chronData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ensembleTable</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">depth</span><span class="op">$</span><span class="va">variableName</span> <span class="op">&lt;-</span> <span class="st">"position"</span></span></code></pre></div>
<div class="section level4">
<h4 id="plotting-the-chronology">Plotting the chronology<a class="anchor" aria-label="anchor" href="#plotting-the-chronology"></a>
</h4>
<p>OK, let’s take a look at the model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chronPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotChronEns.html">plotChronEns</a></span><span class="op">(</span><span class="va">hulu</span>,truncate.dist <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80000</span>,<span class="fl">30000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">chronPlot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p><code><a href="../reference/plotChron.html">plotChron()</a></code> is a wrapper for multiple plotting functions, and has a lot of options, which probably require tinkering to produce a nice plot. See all the options by running <code><a href="../reference/plotChron.html">?plotChron</a></code></p>
</div>
<div class="section level4">
<h4 id="mapping-the-age-ensemble-to-the-paleodata-measurements">Mapping the age ensemble to the paleoData measurements<a class="anchor" aria-label="anchor" href="#mapping-the-age-ensemble-to-the-paleodata-measurements"></a>
</h4>
<p>The ensemble chronology in a chronModel may or may not have values corresponding to the paleoclimatic or paleoenvironmental measurements in paleoData. To map the model ensemble values to a measurement table in paleoData, use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mapAgeEnsembleToPaleoData.html">mapAgeEnsembleToPaleoData</a></span><span class="op">(</span><span class="va">hulu</span>,age.var <span class="op">=</span> <span class="st">"ageEnsemble"</span>,paleo.meas.table.num <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="selecting-the-variables-of-interest">Selecting the variables of interest<a class="anchor" aria-label="anchor" href="#selecting-the-variables-of-interest"></a>
</h4>
<p>Let’s take a look at the this timeseries.</p>
<p>First we’re going to pull out the age ensemble and d18O data for future reference. The <code><a href="../reference/selectData.html">selectData()</a></code> function makes this easy.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu.ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">hulu</span>,var.name <span class="op">=</span> <span class="st">"ageEnsemble"</span>,meas.table.num <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu.d18O</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">hulu</span>,var.name <span class="op">=</span> <span class="st">"d18O"</span>,meas.table.num <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="creating-a-timeseries-plot-as-a-spaghetti-plot-of-lines">Creating a timeseries plot as a spaghetti plot of lines<a class="anchor" aria-label="anchor" href="#creating-a-timeseries-plot-as-a-spaghetti-plot-of-lines"></a>
</h4>
<p>This might be a good time to take a peak at the data, lets plot the ensemble of lines for these</p>
<p>Here we will just plot 50 the data with 50 of its ensemble members.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu.ts.plot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/plotTimeseriesEnsLines.html">plotTimeseriesEnsLines</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">hulu.ae</span>,Y <span class="op">=</span> <span class="va">hulu.d18O</span>,alp <span class="op">=</span> <span class="fl">0.05</span>,n.ens.plot <span class="op">=</span> <span class="fl">50</span>,color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hulu.ts.plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="creating-a-timeseries-plot-with-a-ribbon-confidence-intervals">Creating a timeseries plot with a ribbon confidence intervals<a class="anchor" aria-label="anchor" href="#creating-a-timeseries-plot-with-a-ribbon-confidence-intervals"></a>
</h4>
<p>We can also plot this as a ribbon plot of quantiles</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu.ts.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeseriesEnsRibbons.html">plotTimeseriesEnsRibbons</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">hulu.ae</span>,Y <span class="op">=</span> <span class="va">hulu.d18O</span>,n.bins <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35000</span>,<span class="fl">75000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hulu.ts.plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="combining-the-two-kinds-of-timeseries-plots">Combining the two kinds of timeseries plots<a class="anchor" aria-label="anchor" href="#combining-the-two-kinds-of-timeseries-plots"></a>
</h4>
<p>Or a combination of the two with the “add.to.plot option”</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hulu.ts.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeseriesEnsLines.html">plotTimeseriesEnsLines</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">hulu.ae</span>,Y <span class="op">=</span> <span class="va">hulu.d18O</span>,alp <span class="op">=</span> <span class="fl">0.1</span>,n.ens.plot <span class="op">=</span> <span class="fl">10</span>,color <span class="op">=</span> <span class="st">"red"</span>,add.to.plot <span class="op">=</span> <span class="va">hulu.ts.plot</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Hulu Cave d18O"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hulu.ts.plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="load-in-another-dataset">Load in another dataset<a class="anchor" aria-label="anchor" href="#load-in-another-dataset"></a>
</h3>
<p>Let’s compare these data to the GISP2 ice core.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">gisp2</span> <span class="op">&lt;-</span> <span class="fu">lipdR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lipdR/man/readLipd.html" class="external-link">readLipd</a></span><span class="op">(</span><span class="st">"http://lipdverse.org/geoChronR-examples/GISP2.Alley.2000.lpd"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "reading: GISP2.Alley.2000.lpd"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="use-bam-banded-age-model-to-create-an-age-ensemble">Use BAM (Banded Age Model) to create an age ensemble<a class="anchor" aria-label="anchor" href="#use-bam-banded-age-model-to-create-an-age-ensemble"></a>
</h3>
<p>This is an ice core, so the chronology is not based on radiometric tie points. Let’s use BAM (Banded Age Model) to estimate a 2% counting uncertainty on this. Here we specify all the parameters so it runs in non-interactive mode.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2</span> <span class="op">=</span> <span class="fu"><a href="../reference/runBam.html">runBam</a></span><span class="op">(</span><span class="va">gisp2</span>,</span>
<span>               paleo.num <span class="op">=</span> <span class="fl">1</span>, </span>
<span>               paleo.meas.table.num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               chron.num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               model.num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               ens.table.number <span class="op">=</span> <span class="fl">1</span>, </span>
<span>               make.new <span class="op">=</span> <span class="cn">T</span>,</span>
<span>               n.ens <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>               model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>                            param <span class="op">=</span> <span class="fl">0.02</span>, </span>
<span>                            resize <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                            ns <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span></code></pre></div>
<p>Because BAM runs off of the data in the paleo measurementTable, it puts the ageEnsemble straight into the paleoData, and we don’t need to run `mapAgeEnsembleToPaleoData()’.</p>
<p>You can also always use <code>selectData(gisp2)</code> in interactive mode, and it will list all of the variables.</p>
<div class="section level4">
<h4 id="select-the-relevant-variables">Select the relevant variables<a class="anchor" aria-label="anchor" href="#select-the-relevant-variables"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.d18O</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">gisp2</span>,var.name <span class="op">=</span> <span class="st">"temp"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectData.html">selectData</a></span><span class="op">(</span><span class="va">gisp2</span>,var.name <span class="op">=</span> <span class="st">"yearEnsemble"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Found it! Moving on..."</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.ens</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]     [,2]     [,3]     [,4]     [,5]</span></span>
<span><span class="co">##  [1,] 1854.859 1854.859 1854.859 1854.859 1854.859</span></span>
<span><span class="co">##  [2,] 1842.870 1842.870 1842.870 1842.870 1842.870</span></span>
<span><span class="co">##  [3,] 1836.851 1836.851 1836.851 1842.870 1836.851</span></span>
<span><span class="co">##  [4,] 1830.795 1830.795 1830.795 1836.814 1830.795</span></span>
<span><span class="co">##  [5,] 1830.795 1830.795 1830.795 1836.814 1830.795</span></span>
<span><span class="co">##  [6,] 1824.549 1824.549 1824.549 1830.568 1824.549</span></span>
<span><span class="co">##  [7,] 1817.593 1817.593 1817.593 1823.612 1817.593</span></span>
<span><span class="co">##  [8,] 1811.193 1811.193 1811.193 1817.212 1811.193</span></span>
<span><span class="co">##  [9,] 1804.874 1804.874 1804.874 1810.893 1804.874</span></span>
<span><span class="co">## [10,] 1797.737 1797.737 1797.737 1803.756 1797.737</span></span></code></pre>
<p>Yep - that’s the first 10 entries of the first five age ensembles.</p>
</div>
<div class="section level4">
<h4 id="convert-the-ages-from-years-ad-to-bp">Convert the ages from years AD to BP<a class="anchor" aria-label="anchor" href="#convert-the-ages-from-years-ad-to-bp"></a>
</h4>
<p>Hey, it looks like those might be in calendar years instead of years BP. Let’s check the units</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.ens</span><span class="op">$</span><span class="va">units</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "AD"</span></span></code></pre>
<p>yep. We’d better convert it to BP for comparison with Hulu.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convertAD2BP.html">convertAD2BP</a></span><span class="op">(</span><span class="va">gisp2.ens</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-the-timeseries">Plot the timeseries<a class="anchor" aria-label="anchor" href="#plot-the-timeseries"></a>
</h4>
<p>Let’s make another ribbon and lines plot, this time useing the magrittr pipe to streamline the process</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gisp2.ts.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotTimeseriesEnsRibbons.html">plotTimeseriesEnsRibbons</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">gisp2.ens</span>,Y <span class="op">=</span> <span class="va">gisp2.d18O</span>,n.bins <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plotTimeseriesEnsLines.html">plotTimeseriesEnsLines</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">gisp2.ens</span>,Y <span class="op">=</span> <span class="va">gisp2.d18O</span>,n.ens.plot <span class="op">=</span> <span class="fl">5</span>,color <span class="op">=</span> <span class="st">"Reds"</span>,alp <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"GISP2 temperature"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gisp2.ts.plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="compare-the-two-timeseries">Compare the two timeseries<a class="anchor" aria-label="anchor" href="#compare-the-two-timeseries"></a>
</h3>
<p>Let’s compare the overlapping sections of these records, from about 36 to 50 kyr. We’ll need the gridExtra package for this.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="va">overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36000</span>,<span class="fl">50000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">gisp2.ts.plot</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">overlap</span><span class="op">)</span><span class="op">)</span>,<span class="va">hulu.ts.plot</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">overlap</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will</span></span>
<span><span class="co">## replace the existing scale.</span></span>
<span><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will</span></span>
<span><span class="co">## replace the existing scale.</span></span></code></pre>
<p><img src="Introduction_files/figure-html/unnamed-chunk-16-1.png" width="700"> Interesting. There’s a hint of a negative relationship during this time interval. In <a href="correlation.html">the next vignette</a> we’ll explore ensemble correlation to explore this further. explicitly. Let’s calculate an ensemble correlation and see if shows up.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas McKay, Julien Emile-Geay, Deborah Khider.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '21c1c99b27cf4a45be9f8db70183f6c7',
    indexName: 'lipd-utilities',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
